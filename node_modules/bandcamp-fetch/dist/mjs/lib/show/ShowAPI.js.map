{"version":3,"file":"ShowAPI.js","sourceRoot":"","sources":["../../../../src/lib/show/ShowAPI.ts"],"names":[],"mappings":"AAAA,OAAO,QAAQ,MAAM,mBAAmB,CAAC;AAGzC,OAAO,EAAE,IAAI,EAAE,MAAM,oBAAoB,CAAC;AAC1C,OAAO,EAAE,SAAS,EAAE,MAAM,gBAAgB,CAAC;AAC3C,OAAO,OAAO,MAAM,kBAAkB,CAAC;AACvC,OAAO,cAAc,MAAM,kBAAkB,CAAC;AAC9C,OAAO,UAAU,MAAM,cAAc,CAAC;AAatC,MAAM,CAAC,OAAO,OAAO,OAAO;IAE1B,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC,MAA4B;QAC/C,MAAM,cAAc,GAAG,MAAM,QAAQ,CAAC,YAAY,EAAE,CAAC;QACrD,MAAM,IAAI,GAAG;YACX,OAAO,EAAE,MAAM,CAAC,OAAO;YACvB,YAAY,EAAE,cAAc,CAAC,OAAO;YACpC,gBAAgB,EAAE,MAAM,QAAQ,CAAC,SAAS,CAAC,MAAM,CAAC,gBAAgB,EAAE,CAAC,CAAC;YACtE,iBAAiB,EAAE,MAAM,QAAQ,CAAC,SAAS,CAAC,MAAM,CAAC,iBAAiB,EAAE,EAAE,CAAC;YACzE,eAAe,EAAE,MAAM,QAAQ,CAAC,SAAS,CAAC,MAAM,CAAC,eAAe,EAAE,EAAE,CAAC;SACtE,CAAC;QACF,MAAM,IAAI,GAAG,MAAM,SAAS,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;QAC7C,OAAO,UAAU,CAAC,SAAS,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;IAC1C,CAAC;IAED,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,MAA0B;QAC1C,MAAM,cAAc,GAAG,MAAM,QAAQ,CAAC,YAAY,EAAE,CAAC;QACrD,MAAM,IAAI,GAAG;YACX,YAAY,EAAE,cAAc,CAAC,OAAO;YACpC,WAAW,EAAE,MAAM,QAAQ,CAAC,SAAS,CAAC,MAAM,EAAE,WAAW,EAAE,EAAE,CAAC;SAC/D,CAAC;QACF,MAAM,IAAI,GAAG,MAAM,SAAS,CAAC,IAAI,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC;QAC/C,OAAO,cAAc,CAAC,SAAS,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;IAC9C,CAAC;CACF;AAED,MAAM,OAAO,cAAe,SAAQ,OAAO;IAEzC,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC,MAA4B;QAC/C,OAAO,OAAO,CAAC,QAAQ,CAAC,GAAG,EAAE,CAAC,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC;IACvD,CAAC;IAED,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,MAAsC;QACtD,OAAO,OAAO,CAAC,QAAQ,CAAC,GAAG,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC;IACpD,CAAC;CACF","sourcesContent":["import ImageAPI from '../image/ImageAPI';\nimport { ImageFormat } from '../types/Image';\nimport Show from '../types/Show';\nimport { URLS } from '../utils/Constants';\nimport { fetchPage } from '../utils/Fetch';\nimport Limiter from '../utils/Limiter';\nimport ShowListParser from './ShowListParser';\nimport ShowParser from './ShowParser';\n\nexport interface ShowAPIGetShowParams {\n  showUrl: string,\n  albumImageFormat?: string | number | ImageFormat;\n  artistImageFormat?: string | number | ImageFormat;\n  showImageFormat?: string | number | ImageFormat;\n}\n\nexport interface ShowAPIListParams {\n  imageFormat?: string | number | ImageFormat;\n}\n\nexport default class ShowAPI {\n\n  static async getShow(params: ShowAPIGetShowParams): Promise<Show> {\n    const imageConstants = await ImageAPI.getConstants();\n    const opts = {\n      showUrl: params.showUrl,\n      imageBaseUrl: imageConstants.baseUrl,\n      albumImageFormat: await ImageAPI.getFormat(params.albumImageFormat, 9),\n      artistImageFormat: await ImageAPI.getFormat(params.artistImageFormat, 21),\n      showImageFormat: await ImageAPI.getFormat(params.showImageFormat, 25)\n    };\n    const html = await fetchPage(params.showUrl);\n    return ShowParser.parseShow(html, opts);\n  }\n\n  static async list(params?: ShowAPIListParams) {\n    const imageConstants = await ImageAPI.getConstants();\n    const opts = {\n      imageBaseUrl: imageConstants.baseUrl,\n      imageFormat: await ImageAPI.getFormat(params?.imageFormat, 25)\n    };\n    const json = await fetchPage(URLS.SHOWS, true);\n    return ShowListParser.parseList(json, opts);\n  }\n}\n\nexport class LimiterShowAPI extends ShowAPI {\n\n  static async getShow(params: ShowAPIGetShowParams): Promise<Show> {\n    return Limiter.schedule(() => super.getShow(params));\n  }\n\n  static async list(params?: ShowAPIListParams | undefined): Promise<Show[]> {\n    return Limiter.schedule(() => super.list(params));\n  }\n}\n"]}