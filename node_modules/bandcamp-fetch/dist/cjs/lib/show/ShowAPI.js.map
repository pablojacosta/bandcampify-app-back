{"version":3,"file":"ShowAPI.js","sourceRoot":"","sources":["../../../../src/lib/show/ShowAPI.ts"],"names":[],"mappings":";;;;;;AAAA,iEAAyC;AAGzC,kDAA0C;AAC1C,0CAA2C;AAC3C,+DAAuC;AACvC,sEAA8C;AAC9C,8DAAsC;AAatC,MAAqB,OAAO;IAE1B,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC,MAA4B;QAC/C,MAAM,cAAc,GAAG,MAAM,kBAAQ,CAAC,YAAY,EAAE,CAAC;QACrD,MAAM,IAAI,GAAG;YACX,OAAO,EAAE,MAAM,CAAC,OAAO;YACvB,YAAY,EAAE,cAAc,CAAC,OAAO;YACpC,gBAAgB,EAAE,MAAM,kBAAQ,CAAC,SAAS,CAAC,MAAM,CAAC,gBAAgB,EAAE,CAAC,CAAC;YACtE,iBAAiB,EAAE,MAAM,kBAAQ,CAAC,SAAS,CAAC,MAAM,CAAC,iBAAiB,EAAE,EAAE,CAAC;YACzE,eAAe,EAAE,MAAM,kBAAQ,CAAC,SAAS,CAAC,MAAM,CAAC,eAAe,EAAE,EAAE,CAAC;SACtE,CAAC;QACF,MAAM,IAAI,GAAG,MAAM,IAAA,iBAAS,EAAC,MAAM,CAAC,OAAO,CAAC,CAAC;QAC7C,OAAO,oBAAU,CAAC,SAAS,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;IAC1C,CAAC;IAED,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,MAA0B;QAC1C,MAAM,cAAc,GAAG,MAAM,kBAAQ,CAAC,YAAY,EAAE,CAAC;QACrD,MAAM,IAAI,GAAG;YACX,YAAY,EAAE,cAAc,CAAC,OAAO;YACpC,WAAW,EAAE,MAAM,kBAAQ,CAAC,SAAS,CAAC,MAAM,EAAE,WAAW,EAAE,EAAE,CAAC;SAC/D,CAAC;QACF,MAAM,IAAI,GAAG,MAAM,IAAA,iBAAS,EAAC,gBAAI,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC;QAC/C,OAAO,wBAAc,CAAC,SAAS,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;IAC9C,CAAC;CACF;AAxBD,0BAwBC;AAED,MAAa,cAAe,SAAQ,OAAO;IAEzC,MAAM,CAAC,KAAK,CAAC,OAAO,CAAC,MAA4B;QAC/C,OAAO,iBAAO,CAAC,QAAQ,CAAC,GAAG,EAAE,CAAC,KAAK,CAAC,OAAO,CAAC,MAAM,CAAC,CAAC,CAAC;IACvD,CAAC;IAED,MAAM,CAAC,KAAK,CAAC,IAAI,CAAC,MAAsC;QACtD,OAAO,iBAAO,CAAC,QAAQ,CAAC,GAAG,EAAE,CAAC,KAAK,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC,CAAC;IACpD,CAAC;CACF;AATD,wCASC","sourcesContent":["import ImageAPI from '../image/ImageAPI';\nimport { ImageFormat } from '../types/Image';\nimport Show from '../types/Show';\nimport { URLS } from '../utils/Constants';\nimport { fetchPage } from '../utils/Fetch';\nimport Limiter from '../utils/Limiter';\nimport ShowListParser from './ShowListParser';\nimport ShowParser from './ShowParser';\n\nexport interface ShowAPIGetShowParams {\n  showUrl: string,\n  albumImageFormat?: string | number | ImageFormat;\n  artistImageFormat?: string | number | ImageFormat;\n  showImageFormat?: string | number | ImageFormat;\n}\n\nexport interface ShowAPIListParams {\n  imageFormat?: string | number | ImageFormat;\n}\n\nexport default class ShowAPI {\n\n  static async getShow(params: ShowAPIGetShowParams): Promise<Show> {\n    const imageConstants = await ImageAPI.getConstants();\n    const opts = {\n      showUrl: params.showUrl,\n      imageBaseUrl: imageConstants.baseUrl,\n      albumImageFormat: await ImageAPI.getFormat(params.albumImageFormat, 9),\n      artistImageFormat: await ImageAPI.getFormat(params.artistImageFormat, 21),\n      showImageFormat: await ImageAPI.getFormat(params.showImageFormat, 25)\n    };\n    const html = await fetchPage(params.showUrl);\n    return ShowParser.parseShow(html, opts);\n  }\n\n  static async list(params?: ShowAPIListParams) {\n    const imageConstants = await ImageAPI.getConstants();\n    const opts = {\n      imageBaseUrl: imageConstants.baseUrl,\n      imageFormat: await ImageAPI.getFormat(params?.imageFormat, 25)\n    };\n    const json = await fetchPage(URLS.SHOWS, true);\n    return ShowListParser.parseList(json, opts);\n  }\n}\n\nexport class LimiterShowAPI extends ShowAPI {\n\n  static async getShow(params: ShowAPIGetShowParams): Promise<Show> {\n    return Limiter.schedule(() => super.getShow(params));\n  }\n\n  static async list(params?: ShowAPIListParams | undefined): Promise<Show[]> {\n    return Limiter.schedule(() => super.list(params));\n  }\n}\n"]}